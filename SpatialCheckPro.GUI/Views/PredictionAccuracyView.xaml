<Window x:Class="SpatialCheckPro.GUI.Views.PredictionAccuracyView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="예측 정확도 분석" Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        Background="#F3F4F6">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 헤더 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="검수 시간 예측 정확도 분석" FontSize="24" FontWeight="Bold" Foreground="#1F2937"/>
            <TextBlock Text="최근 검수 실행 데이터를 기반으로 예측 정확도를 분석합니다" FontSize="14" Foreground="#6B7280" Margin="0,5,0,0"/>
        </StackPanel>
        
        <!-- 분석 결과 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- 전체 정확도 요약 -->
                <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                            <TextBlock Text="전체 정확도" FontSize="12" Foreground="#6B7280" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="OverallAccuracyText" Text="85.2%" FontSize="24" FontWeight="Bold" Foreground="#10B981" HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                            <TextBlock Text="평균 편차" FontSize="12" Foreground="#6B7280" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="AverageDeviationText" Text="±12.5초" FontSize="24" FontWeight="Bold" Foreground="#3B82F6" HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                            <TextBlock Text="학습 데이터" FontSize="12" Foreground="#6B7280" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="DataCountText" Text="25개" FontSize="24" FontWeight="Bold" Foreground="#8B5CF6" HorizontalAlignment="Center"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                            <TextBlock Text="개선율" FontSize="12" Foreground="#6B7280" HorizontalAlignment="Center"/>
                            <TextBlock x:Name="ImprovementRateText" Text="+15%" FontSize="24" FontWeight="Bold" Foreground="#F59E0B" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- 단계별 정확도 -->
                <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="단계별 예측 정확도" FontSize="16" FontWeight="SemiBold" Foreground="#1F2937" Margin="0,0,0,15"/>
                        
                        <ItemsControl x:Name="StageAccuracyList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="0,10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="100"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0" Text="{Binding StageName}" FontWeight="Medium" VerticalAlignment="Center"/>
                                            
                                            <ProgressBar Grid.Column="1" Value="{Binding AccuracyPercent}" Maximum="100" Height="6" Margin="10,0">
                                                <ProgressBar.Foreground>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#10B981" Offset="0"/>
                                                        <GradientStop Color="#3B82F6" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </ProgressBar.Foreground>
                                            </ProgressBar>
                                            
                                            <TextBlock Grid.Column="2" Text="{Binding AccuracyPercent, StringFormat={}{0:F1}%}" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                            <TextBlock Grid.Column="3" Text="{Binding AverageDeviation, StringFormat=±{0:F1}초}" HorizontalAlignment="Right" VerticalAlignment="Center" Foreground="#6B7280"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
                
                <!-- 최근 실행 비교 -->
                <Border Background="White" CornerRadius="8" Padding="20">
                    <StackPanel>
                        <TextBlock Text="최근 실행 비교" FontSize="16" FontWeight="SemiBold" Foreground="#1F2937" Margin="0,0,0,15"/>
                        
                        <DataGrid x:Name="RecentRunsGrid" 
                                  AutoGenerateColumns="False" 
                                  IsReadOnly="True"
                                  GridLinesVisibility="Horizontal"
                                  HeadersVisibility="Column"
                                  Background="Transparent"
                                  BorderThickness="0"
                                  MaxHeight="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="실행 시간" Binding="{Binding RunTime, StringFormat={}{0:yyyy-MM-dd HH:mm}}" Width="150"/>
                                <DataGridTextColumn Header="파일명" Binding="{Binding FileName}" Width="200"/>
                                <DataGridTextColumn Header="예측 시간" Binding="{Binding PredictedTime, StringFormat={}{0:mm\\:ss}}" Width="100"/>
                                <DataGridTextColumn Header="실제 시간" Binding="{Binding ActualTime, StringFormat={}{0:mm\\:ss}}" Width="100"/>
                                <DataGridTextColumn Header="정확도" Binding="{Binding Accuracy, StringFormat={}{0:F1}%}" Width="80"/>
                                <DataGridTextColumn Header="편차" Binding="{Binding Deviation, StringFormat={}{0:+#;-#;0}초}" Width="80"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- 버튼 -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button x:Name="ClearDataButton" Content="학습 데이터 초기화" 
                    Padding="15,8" Margin="0,0,10,0"
                    Background="#EF4444" Foreground="White" 
                    BorderThickness="0" Click="ClearDataButton_Click">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="6"/>
                    </Style>
                </Button.Resources>
            </Button>
            <Button x:Name="CloseButton" Content="닫기" 
                    Padding="15,8" 
                    Background="#6B7280" Foreground="White" 
                    BorderThickness="0" Click="CloseButton_Click">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="6"/>
                    </Style>
                </Button.Resources>
            </Button>
        </StackPanel>
    </Grid>
</Window>
